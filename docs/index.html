<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>ticker-data preview</title>
    <style>
      body { font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 24px; line-height: 1.5; }
      header { margin-bottom: 16px; }
      pre { background: #f6f8fa; padding: 12px; border-radius: 6px; overflow: auto; }
      .msg { border: 1px solid #e5e7eb; border-radius: 8px; padding: 8px 12px; margin: 6px 0; }
      .muted { color: #6b7280; }
      .row { display: flex; gap: 8px; align-items: center; }
    </style>
  </head>
  <body>
    <header>
      <h1>ticker-data 미리보기</h1>
      <div class="row">
        <label>언어
          <select id="lang">
            <option value="ko">한국어</option>
            <option value="en">English</option>
            <option value="ja">日本語</option>
            <option value="es">Español</option>
            <option value="zh">中文</option>
            <option value="de">Deutsch</option>
            <option value="fr">Français</option>
          </select>
        </label>
        <span id="status" class="muted"></span>
      </div>
    </header>
    <main id="app"></main>
    <h3>Raw JSON</h3>
    <pre id="raw"></pre>
    <script>
      async function load(lang) {
        const today = new Date().toISOString().slice(0,10);
        const url = `./messages.${lang}.json?v=${today}`;
        const res = await fetch(url, { cache: 'no-store' });
        if (!res.ok) throw new Error('Failed to load ' + url);
        const data = await res.json();
        const app = document.getElementById('app');
        app.innerHTML = '';
        const meta = document.createElement('div');
        meta.className = 'muted';
        meta.textContent = (data.version || '') + ' · ' + (data.lastUpdated || data?.meta?.updatedAt || '');
        app.appendChild(meta);
        (data.messages || []).forEach((m) => {
          const d = document.createElement('div');
          d.className = 'msg';
          d.innerHTML = (m.text || '').toString();
          app.appendChild(d);
        });
        document.getElementById('raw').textContent = JSON.stringify(data, null, 2);
        document.getElementById('status').textContent = '';
      }
      const sel = document.getElementById('lang');
      sel.addEventListener('change', () => load(sel.value).catch(err => { document.getElementById('status').textContent = '로드 실패: ' + err.message; }));
      load('ko').catch(err => { document.getElementById('status').textContent = '로드 실패: ' + err.message; });
    </script>
  </body>
  </html>

